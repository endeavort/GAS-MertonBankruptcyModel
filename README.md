# 破産確率ビジュアライザー

## 概要
`BankruptcyProbabilityVisualizer.gs` は、取引戦略のリスク管理において重要な指標である破産確率を計算し、その結果を色分けしてGoogleスプレッドシートに表示するためのGoogle Apps Scriptです。勝率、リスクリワード比、リスク率、初期資金、撤退ラインなどのパラメータに基づいて、破産確率を算出し、結果を視覚的に理解しやすい形で提供します。

## 機能
- **破産確率の計算:** 勝率、リスクリワード比、リスク率、初期資金、撤退ラインをパラメータとして使用して破産確率を計算します。
- **色分け表示:** 計算された破産確率に基づいて、スプレッドシートのセルに対して色分けを行い、リスクの大きさを視覚的に表現します。
  - 100%（赤）
  - 10%以上100%未満（オレンジ）
  - 1%以上10%未満（黄色）
  - 1%未満（黄緑）
  - 0%（緑）
- **自動フォーマット:** スプレッドシート上に勝率とリスクリワード比の範囲を自動で生成し、適切なフォーマットで結果を表示します。

## 設定方法
1. Googleスプレッドシートを開きます。
2. 「ツール」メニューから「スクリプトエディタ」を選択します。
3. スクリプトエディタで新しいスクリプトファイルを作成し、`BankruptcyProbabilityVisualizer.gs` のコードをコピー＆ペーストします。
4. スクリプトエディタで保存し、スプレッドシートに戻ります。

## 使い方
1. スプレッドシートに必要なパラメータ（初期資金、リスク率、撤退ラインなど）を入力します。
2. スクリプトが提供する関数を使用して、破産確率の計算を実行します。これは、スクリプトエディタ内で関数を直接実行するか、スプレッドシート上でカスタムメニューまたはボタンから実行できます。
3. 計算後、スプレッドシートは自動的に更新され、各セルは破産確率に応じて色分けされます。

## 注意事項
- このスクリプトは、Googleスプレッドシートでの使用を前提としています。
- 正確な計算結果を得るためには、適切なパラメータ値を入力することが重要です。
- 色分けの閾値は、スクリプト内で調整することが可能です。
